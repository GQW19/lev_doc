> Lev库，I/O，数据存储等

> 比如Cr的接口规范以及不同调用示例

# 用户中心使用说明



### 用户中心核心功能：

1. 登录注册功能
2. 用户授权功能
3. 业务相关功能(企业，验证码，短信)

### 接口全局公共返回参数

| 参数名 | 类型    | 是否返回 | 说明                                           |
| ------ | ------- | -------- | ---------------------------------------------- |
| status | integer | true     | 接口请求状态码，http状态码，400，401等         |
| msg    | string  | true     | 接口错误提示，请求成功时返回空字符串           |
| data   | object  | true     | 接口请求成功返回数据，<br />请求失败时返回null |

#### 登录注册功能：

1. 登录(用户名密码)

   * URL:	`/login`

   * 请求方式：GET,POST

   * 接口说明：用户名密码登录，常规登录模式

   * 参数列表

     | 参数名   | 类型   | 是否必传 | 说明   |
     | -------- | ------ | -------- | ------ |
     | username | string | true     | 用户名 |
     | password | string | true     | 密码   |

   * 接口返回数据(异常数据原因请看提示)

     | 参数名 | 类型    | 必定返回 | 说明         |
     | ------ | ------- | -------- | ------------ |
     | login  | Boolean | true     | 是否登录成功 |
     | roles  | Array   | true     | 用户组       |

2. 登录(手机号验证码登录)

   * URL:	`/login/sms`

   * 请求方式：POST

   * 接口说明：手机号验证码登录

   * 参数列表

     | 参数名 | 类型   | 是否必传 | 说明       |
     | ------ | ------ | -------- | ---------- |
     | mobile | string | true     | 手机号码   |
     | code   | string | true     | 短信验证码 |

   * 接口返回数据(异常数据原因请看提示)

     | 参数名 | 类型    | 必定返回 | 说明         |
     | ------ | ------- | -------- | ------------ |
     | login  | Boolean | true     | 是否登录成功 |
     | roles  | Array   | true     | 用户组       |

3. 发送短信验证码

   * URL:	`/sms`

   * 请求方式：GET

   * 接口说明：发送短信验证码

   * 参数列表

     | 参数名       | 类型   | 是否必传 | 说明         |
     | ------------ | ------ | -------- | ------------ |
     | mobile       | string | true     | 手机号码     |
     | captchaVlaue | string | true     | 图像验证码   |
     | captchaId    | string | true     | 图像验证码id |

   * 接口返回数据(异常数据原因请看提示)

     | 参数名 | 类型    | 必定返回 | 说明         |
     | ------ | ------- | -------- | ------------ |
     | login  | Boolean | true     | 是否登录成功 |
     | roles  | Array   | true     | 用户组       |

4. 获取图片验证码

   * URL:	`/captcha`

   * 请求方式：GET

   * 接口说明：获取图片验证码

   * 参数列表

     | 参数名 | 类型 | 是否必传 | 说明 |
     | ------ | ---- | -------- | ---- |
     | null   | null | false    | null |

   * 接口返回数据(异常数据原因请看提示)

     | 参数名     | 类型   | 必定返回 | 说明                   |
     | ---------- | ------ | -------- | ---------------------- |
     | captchaImg | string | true     | 图像验证码Base64字符串 |
     | captchaId  | string | true     | 图像验证码id           |



### 用户授权功能

1. 获取token功能

   * URL:	`/oauth/token`

   * 请求方式：GET,POST

   * 接口说明：获取授权的token,此接口有些复杂，需要多种

     * 无参数获取，必须要求是已登录状态，即已经访问过"/login"接口且登录成功
     * grant_type为sms_code，即手机验证码登录方式，必须访问过短信验证码接口
     * grant_type为client_

   * 参数列表

     | 参数名       | 类型   | 是否必传 | 说明             |
     | ------------ | ------ | -------- | ---------------- |
     | grant_type   | string | false    | 授权类型         |
     | client_id    | string | false    | 申请授权客户端id |
     | redirect_uri |        |          |                  |

   * 接口返回数据(异常数据原因请看提示)

     | 参数名      | 类型   | 必定返回 | 说明                   |
     | ----------- | ------ | -------- | ---------------------- |
     | userId      | INT    | true     | 用户id                 |
     | jti         | String | true     | 框架返回参数，作用未知 |
     | accessToken | String | true     | JWT,用户凭证           |
     | expiration  | Long   | true     | JWT过期时间            |

   * 接口返回示例：

     ```json
     {
         "msg": "",
         "data": {
             "userId": 6,
             "jti": "9b6dbedf-03fc-45ad-9d31-62a6266ebd66",
             "accessToken": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX25hbWUiOiJtYWNybyIsInNjb3BlIjpbImFsbCJdLCJleHAiOjE1ODI4OTEwMzIsInVzZXJJZCI6NiwiYXV0aG9yaXRpZXMiOlsiYWRtaW4iXSwianRpIjoiOWI2ZGJlZGYtMDNmYy00NWFkLTlkMzEtNjJhNjI2NmViZDY2IiwiY2xpZW50X2lkIjoidGVzdCJ9.PF_QgPojLco1N7c9cQO-XpF7E5aB5m79xZiusPSSb7Q",
             "expiration": 1582891032211
         },
         "status": 200
     }
     ```
