## 框架综述
g
### 潮汐平台介绍

潮汐平台是一个安全攻防工具的在线使用平台，包含了广为人知的大众款、小而美的垂直类工具、或是社区贡献者独立/二次开发的实用类工具。

依托于MongoDB数据库和Docker技术，潮汐开源平台有能力聚合多样化的测试工具，实现安全工具平台一体化，docker对工具的封装免去了构建工具环境的麻烦，MongoDB有能力聚合不同工具的测试结果，开源的平台保证了工具和用户的多样性。因此，在使用潮汐时，用户无需进行工具的安装或环境的配置，即可一键开启使用多种工具，在线对安全资产进行检测，或完成一些简单的自动化任务

而对于开发者来说，潮汐支持开发者使用容易上手的编程语言python，整个开发过程是基于平台设计的模版进行的，仅需要编写少量核心代码，即可完成工具集成或编排开发。

潮汐开源平台能够快速一键关联开发者的github账号，调用开发者在github上托管的dockerfile，开发者无需在潮汐开源平台上重新进行上传或者镜像文件的版本控制。

开发者所编写的dockerfile可直接在潮汐开源平台的自主镜像管理系统上构建，无需使用开发者本地的计算资源，可直接在潮汐开源平台上管理自己上传的镜像。

此外，潮汐以工具文件夹为单位直接将整个文件夹进行打包和封装，上传至潮汐开源平台。其他编写者可以按包为单位轻松地在自己的编排中调用任意用户所编写的开放式工具包。

### 技术架构图

略

### 名词介绍

1. 工具

   即开发者会用到的，执行特定功能的脚本，应用程序等，例如 nmap，checkamrc 等

2. 模式

   模式其实是工具的封装，一个安全工具通常会有很多参数，每次使用的时候，可能都需要查询使用文档组合构建这些参数，极为麻烦

   而在潮汐平台，你可以将这些参数，或者工具一些比较常用且固定的参数名、命令、或者使用方式等，封装成特定的函数

   这些封装好了的函数，即为 模式

   例如：

   ```bash
   $ nmap -sS -Pn -p- -T4 --open -O -oX /tmp/port_os.xml 192.168.1.1/24
   ```

   这条命令就可以包装成 nmap 工具的一个模式

3. 编排

   简单理解，编排即 模式的集合

   在执行特定的渗透任务时，可能为了某个目标任务，需要同时用到多个工具或者多个模式 组合来完成，而这些组合其实都是可以抽象，自动化的，那么便可以将其抽象成一个函数，这也就是所谓的编排

### 数据存储与数据安全

潮汐平台会在您的本地通过 dcoker 建立一个 mongodb 数据库，然后将您每次运行的任务数据都以 json 的形式持久化到 mongodb，您可以在使用的时候随时调取使用，潮汐平台不会私自将您的数据上传到互联网

### agent 作用

在用户本地创建一个消息队列，这个消息队列中间件集成在 agent 中，存储所有的用户信息，包括 用户创建的任务，任务的执行过程，状态变化等等都会存储在消息日志中， 

### 为什么编排要用异步

潮汐平台考虑到各种用户场景，试图尽力降低用户门槛，在选择各种技术方案的时候发现，异步是针对各种应用场景时，门槛最低，效率最高，最优化的方案，且潮汐平台利用到的组件中有异步组件

### Cr 做了什么

Cr() 函数会返回一个 Cr 对象，Cr对象定义了一个容器，但是还未启动容器。当执行 await 方法的时候，Cr 会在 容器内部新建一个 task，开始执行 entry() 方法中的逻辑，最后会将执行结果存入 mongodb 中

### Docker 的作用

容器化技术方便部署工具，并且提供轻量级的隔离，相对保证了工具执行时的系统环境和工具依赖的纯净，避免了不同操作系统不同环境的干扰
